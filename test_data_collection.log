2025-10-12 19:23:09,166 [INFO] __main__: ================================================================================
2025-10-12 19:23:09,168 [INFO] __main__: üöÄ STARTING COMPREHENSIVE DATA COLLECTION TEST
2025-10-12 19:23:09,169 [INFO] __main__: üöÄ –ó–ê–ü–£–°–ö –ö–û–ú–ü–õ–ï–ö–°–ù–û–ì–û –¢–ï–°–¢–ê –°–ë–û–†–ê –î–ê–ù–ù–´–•
2025-10-12 19:23:09,170 [INFO] __main__: ================================================================================
2025-10-12 19:23:09,170 [INFO] __main__: 
üîç Test 1: Database Connection / –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
2025-10-12 19:23:09,170 [ERROR] __main__: ‚ùå Database connection failed: PG_DSN is not set
2025-10-12 19:23:09,170 [ERROR] __main__: 
‚ùå Database not available, stopping tests
2025-10-12 19:23:09,170 [INFO] __main__: 
================================================================================
2025-10-12 19:23:09,170 [INFO] __main__: üìä SUMMARY OF TESTS / –ò–¢–û–ì–ò –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø
2025-10-12 19:23:09,170 [INFO] __main__: ================================================================================
2025-10-12 19:23:09,170 [INFO] __main__: 1. ‚ùå FAIL: Database Connection
2025-10-12 19:23:09,170 [INFO] __main__:    Details: PG_DSN is not set
2025-10-12 19:23:09,170 [INFO] __main__: ================================================================================
2025-10-12 19:23:09,170 [INFO] __main__: Success Rate: 0/1 (0.0%)
2025-10-12 19:23:09,170 [INFO] __main__: Total Duration: 0.00s
2025-10-12 19:23:09,170 [INFO] __main__: ================================================================================
2025-10-12 19:23:34,943 [INFO] __main__: ================================================================================
2025-10-12 19:23:34,945 [INFO] __main__: üöÄ STARTING COMPREHENSIVE DATA COLLECTION TEST
2025-10-12 19:23:34,946 [INFO] __main__: üöÄ –ó–ê–ü–£–°–ö –ö–û–ú–ü–õ–ï–ö–°–ù–û–ì–û –¢–ï–°–¢–ê –°–ë–û–†–ê –î–ê–ù–ù–´–•
2025-10-12 19:23:34,946 [INFO] __main__: ================================================================================
2025-10-12 19:23:34,946 [INFO] __main__: 
üîç Test 1: Database Connection / –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
2025-10-12 19:23:34,988 [ERROR] __main__: ‚ùå Required tables not found
2025-10-12 19:23:34,988 [ERROR] __main__: 
‚ùå Database not available, stopping tests
2025-10-12 19:23:34,990 [INFO] __main__: 
================================================================================
2025-10-12 19:23:34,990 [INFO] __main__: üìä SUMMARY OF TESTS / –ò–¢–û–ì–ò –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø
2025-10-12 19:23:34,990 [INFO] __main__: ================================================================================
2025-10-12 19:23:34,990 [INFO] __main__: 1. ‚ùå FAIL: Database Connection
2025-10-12 19:23:34,990 [INFO] __main__:    Details: Missing tables. Found: ['listings']
2025-10-12 19:23:34,990 [INFO] __main__: ================================================================================
2025-10-12 19:23:34,991 [INFO] __main__: Success Rate: 0/1 (0.0%)
2025-10-12 19:23:34,991 [INFO] __main__: Total Duration: 0.05s
2025-10-12 19:23:34,992 [INFO] __main__: ================================================================================
2025-10-12 19:24:13,789 [INFO] __main__: ================================================================================
2025-10-12 19:24:13,793 [INFO] __main__: üöÄ STARTING COMPREHENSIVE DATA COLLECTION TEST
2025-10-12 19:24:13,793 [INFO] __main__: üöÄ –ó–ê–ü–£–°–ö –ö–û–ú–ü–õ–ï–ö–°–ù–û–ì–û –¢–ï–°–¢–ê –°–ë–û–†–ê –î–ê–ù–ù–´–•
2025-10-12 19:24:13,793 [INFO] __main__: ================================================================================
2025-10-12 19:24:13,793 [INFO] __main__: 
üîç Test 1: Database Connection / –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
2025-10-12 19:24:13,823 [INFO] __main__: ‚úÖ Database connected, tables exist
2025-10-12 19:24:13,830 [INFO] __main__:    Current data: 4 listings, 4 prices
2025-10-12 19:24:13,830 [INFO] __main__: 
üîç Test 2: Payload Loading / –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
2025-10-12 19:24:13,836 [ERROR] __main__: ‚ùå Missing required fields: ['engine_version', 'offer_type', 'deal_type', 'region']
2025-10-12 19:24:13,837 [ERROR] __main__: 
‚ùå Cannot proceed without valid payload
2025-10-12 19:24:13,837 [INFO] __main__: 
================================================================================
2025-10-12 19:24:13,837 [INFO] __main__: üìä SUMMARY OF TESTS / –ò–¢–û–ì–ò –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø
2025-10-12 19:24:13,839 [INFO] __main__: ================================================================================
2025-10-12 19:24:13,839 [INFO] __main__: 1. ‚úÖ PASS: Database Connection
2025-10-12 19:24:13,839 [INFO] __main__:    Details: Tables found: ['listing_prices', 'listings']
2025-10-12 19:24:13,839 [INFO] __main__: 2. ‚ùå FAIL: Payload Loading
2025-10-12 19:24:13,839 [INFO] __main__:    Details: Missing fields: ['engine_version', 'offer_type', 'deal_type', 'region']
2025-10-12 19:24:13,839 [INFO] __main__: ================================================================================
2025-10-12 19:24:13,839 [INFO] __main__: Success Rate: 1/2 (50.0%)
2025-10-12 19:24:13,839 [INFO] __main__: Total Duration: 0.05s
2025-10-12 19:24:13,839 [INFO] __main__: ================================================================================
2025-10-12 19:24:42,224 [INFO] __main__: ================================================================================
2025-10-12 19:24:42,228 [INFO] __main__: üöÄ STARTING COMPREHENSIVE DATA COLLECTION TEST
2025-10-12 19:24:42,228 [INFO] __main__: üöÄ –ó–ê–ü–£–°–ö –ö–û–ú–ü–õ–ï–ö–°–ù–û–ì–û –¢–ï–°–¢–ê –°–ë–û–†–ê –î–ê–ù–ù–´–•
2025-10-12 19:24:42,228 [INFO] __main__: ================================================================================
2025-10-12 19:24:42,228 [INFO] __main__: 
üîç Test 1: Database Connection / –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
2025-10-12 19:24:42,252 [INFO] __main__: ‚úÖ Database connected, tables exist
2025-10-12 19:24:42,258 [INFO] __main__:    Current data: 4 listings, 4 prices
2025-10-12 19:24:42,261 [INFO] __main__: 
üîç Test 2: Payload Loading / –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
2025-10-12 19:24:42,266 [INFO] __main__: ‚úÖ Payload loaded successfully: 8 filters in jsonQuery
2025-10-12 19:24:42,269 [INFO] __main__:    Limit: 20, Sort: creation_date_desc
2025-10-12 19:24:42,269 [INFO] __main__: 
üîç Test 3: Data Collection / –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
2025-10-12 19:24:42,269 [INFO] __main__: Collecting data from CIAN (1 page)...
2025-10-12 19:24:42,881 [INFO] httpx: HTTP Request: POST https://www.cian.ru/site/v1/offers/search/grouped/ "HTTP/1.1 404 Not Found"
2025-10-12 19:24:46,002 [INFO] httpx: HTTP Request: POST https://www.cian.ru/site/v1/offers/search/grouped/ "HTTP/1.1 404 Not Found"
2025-10-12 19:24:48,396 [INFO] httpx: HTTP Request: POST https://www.cian.ru/site/v1/offers/search/grouped/ "HTTP/1.1 404 Not Found"
2025-10-12 19:24:48,397 [ERROR] __main__: ‚ùå Data collection failed: RetryError[<Future at 0x74e0ae508d40 state=finished raised CianBlockedError>]
2025-10-12 19:24:48,398 [INFO] __main__: 
üîç Test 4: Data Mapping / –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
2025-10-12 19:24:48,399 [WARNING] __main__: ‚ö†Ô∏è  No offers to map
2025-10-12 19:24:48,399 [INFO] __main__: 
üîç Test 5: Database Upsert / –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
2025-10-12 19:24:48,399 [WARNING] __main__: ‚ö†Ô∏è  No data to save
2025-10-12 19:24:48,399 [INFO] __main__: 
üîç Test 6: Data Retrieval / –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2025-10-12 19:24:48,416 [INFO] __main__: ‚úÖ Data retrieved successfully: 4 listings
2025-10-12 19:24:48,417 [INFO] __main__: 
   Latest listings:
2025-10-12 19:24:48,418 [INFO] __main__:    1. ID: 322341323
2025-10-12 19:24:48,418 [INFO] __main__:       Address: Unknown...
2025-10-12 19:24:48,418 [INFO] __main__:       Area: 40.1 m¬≤, Floor: 11, Rooms: 2
2025-10-12 19:24:48,418 [INFO] __main__:       Price: 24,580,000 RUB
2025-10-12 19:24:48,418 [INFO] __main__:    2. ID: 315562134
2025-10-12 19:24:48,418 [INFO] __main__:       Address: Unknown...
2025-10-12 19:24:48,418 [INFO] __main__:       Area: 77.4 m¬≤, Floor: 9, Rooms: 3
2025-10-12 19:24:48,418 [INFO] __main__:       Price: 25,500,000 RUB
2025-10-12 19:24:48,418 [INFO] __main__:    3. ID: 318570417
2025-10-12 19:24:48,418 [INFO] __main__:       Address: Unknown...
2025-10-12 19:24:48,418 [INFO] __main__:       Area: 77.3 m¬≤, Floor: 5, Rooms: 3
2025-10-12 19:24:48,418 [INFO] __main__:       Price: 22,250,000 RUB
2025-10-12 19:24:48,418 [INFO] __main__:    4. ID: 305914265
2025-10-12 19:24:48,418 [INFO] __main__:       Address: Unknown...
2025-10-12 19:24:48,418 [INFO] __main__:       Area: 49.8 m¬≤, Floor: 2, Rooms: 2
2025-10-12 19:24:48,418 [INFO] __main__:       Price: 23,176,920 RUB
2025-10-12 19:24:48,419 [INFO] __main__: 
üîç Test 7: Algorithm Logic / –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ (SCD Type 2)
2025-10-12 19:24:48,441 [INFO] __main__: ‚úÖ SCD Type 2 ready (no price changes detected yet)
2025-10-12 19:24:48,444 [INFO] __main__: 
================================================================================
2025-10-12 19:24:48,444 [INFO] __main__: üìä SUMMARY OF TESTS / –ò–¢–û–ì–ò –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø
2025-10-12 19:24:48,444 [INFO] __main__: ================================================================================
2025-10-12 19:24:48,444 [INFO] __main__: 1. ‚úÖ PASS: Database Connection
2025-10-12 19:24:48,444 [INFO] __main__:    Details: Tables found: ['listing_prices', 'listings']
2025-10-12 19:24:48,444 [INFO] __main__: 2. ‚úÖ PASS: Payload Loading
2025-10-12 19:24:48,444 [INFO] __main__:    Details: Loaded payload with 8 filters
2025-10-12 19:24:48,444 [INFO] __main__: 3. ‚ùå FAIL: Data Collection
2025-10-12 19:24:48,444 [INFO] __main__:    Details: RetryError[<Future at 0x74e0ae508d40 state=finished raised CianBlockedError>]
2025-10-12 19:24:48,444 [INFO] __main__: 4. ‚ùå FAIL: Data Mapping
2025-10-12 19:24:48,444 [INFO] __main__:    Details: No offers to map
2025-10-12 19:24:48,444 [INFO] __main__: 5. ‚ùå FAIL: Database Upsert
2025-10-12 19:24:48,444 [INFO] __main__:    Details: No data to save
2025-10-12 19:24:48,444 [INFO] __main__: 6. ‚úÖ PASS: Data Retrieval
2025-10-12 19:24:48,444 [INFO] __main__:    Details: Retrieved 4 listings
2025-10-12 19:24:48,444 [INFO] __main__: 7. ‚úÖ PASS: Algorithm Logic (SCD2)
2025-10-12 19:24:48,444 [INFO] __main__:    Details: No price changes yet (expected for first run)
2025-10-12 19:24:48,444 [INFO] __main__: ================================================================================
2025-10-12 19:24:48,444 [INFO] __main__: Success Rate: 4/7 (57.1%)
2025-10-12 19:24:48,444 [INFO] __main__: Total Duration: 6.22s
2025-10-12 19:24:48,444 [INFO] __main__: ================================================================================
2025-10-12 19:24:48,448 [INFO] __main__: 
üìÑ Results saved to: /opt/realestate/logs/test_results.json
2025-10-12 19:24:48,449 [WARNING] __main__: 
‚ö†Ô∏è  SOME TESTS FAILED / –ù–ï–ö–û–¢–û–†–´–ï –¢–ï–°–¢–´ –ù–ï –ü–†–û–®–õ–ò
