# –ù–æ—á–Ω–∞—è –†–∞–±–æ—Ç–∞ - –û—Ç—á—ë—Ç üåô

**–î–∞—Ç–∞:** 2025-11-03 21:00-22:00 UTC  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ó–ê–î–ê–ß–ò –í–´–ü–û–õ–ù–ï–ù–´

---

## üéØ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ó–∞–¥–∞—á–∏

### ‚úÖ TASK-001: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–∞ (–ö–†–ò–¢–ò–ß–ù–û)
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–∞—Ä—Å–µ—Ä –∏–∑–≤–ª–µ–∫–∞–ª —Ç–æ–ª—å–∫–æ 48% –¥–∞–Ω–Ω—ã—Ö (rooms, area, floor)  
**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ - –ø—Ä–æ–≤–µ—Ä–∫–∞ OfferSubtitle + OfferTitle  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** **100% –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –ø–æ–ª–µ–π** ‚ú®

**–ú–µ—Ç—Ä–∏–∫–∏:**
```
–î–û:  rooms=48.6%, area=32.5%, floor=32.1%
–ü–û–°–õ–ï: rooms=100%, area=100%, floor=100%
```

---

### ‚úÖ TASK-003: –î–µ—Ç–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- –í–∫–ª—é—á–µ–Ω `--parse-details` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –î–æ–±–∞–≤–ª–µ–Ω SQL view `data_quality_metrics` –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –¢–µ–ø–µ—Ä—å —Å–æ–±–∏—Ä–∞—é—Ç—Å—è: –æ–ø–∏—Å–∞–Ω–∏—è, —Ñ–æ—Ç–æ, –¥–∞—Ç—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏

**–ö–æ–º–∞–Ω–¥—ã:**
```bash
# –ó–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–∞ (–¥–µ—Ç–∞–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
python -m etl.collector_cian.cli to-db --pages 10

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞
psql $PG_DSN -c "SELECT * FROM data_quality_metrics;"
```

---

### ‚úÖ TASK-004: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫
**–ß—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:**
- Systemd service + timer
- –ó–∞–ø—É—Å–∫: **–ï–∂–µ–¥–Ω–µ–≤–Ω–æ –≤ 3:00 AM UTC**
- –õ–æ–≥–∏: `~/realestate/logs/cian-scraper.log`

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# –°—Ç–∞—Ç—É—Å —Ç–∞–π–º–µ—Ä–∞
sudo systemctl status cian-scraper.timer

# –ë–ª–∏–∂–∞–π—à–∏–π –∑–∞–ø—É—Å–∫
systemctl list-timers cian-scraper.timer

# –õ–æ–≥–∏
tail -f logs/cian-scraper.log
```

**–°–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—É—Å–∫:** –ó–∞–≤—Ç—Ä–∞ –≤ 03:00 UTC ‚è∞

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –°–≤–µ–∂–∏–π –ø–∞—Ä—Å–∏–Ω–≥ (5 —Å—Ç—Ä–∞–Ω–∏—Ü)
```
–í—Ä–µ–º—è: 1.9 –º–∏–Ω—É—Ç—ã
–û–±—ä—è–≤–ª–µ–Ω–∏–π: 140
–ù–æ–≤—ã—Ö —Ü–µ–Ω: 140

–ö–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö:
  Rooms: 100.0% ‚úÖ
  Area: 100.0% ‚úÖ
  Floor: 100.0% ‚úÖ
  Address: 100.0% ‚úÖ
```

### –ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö
```sql
SELECT id, rooms, area_total, floor, LEFT(address, 40)
FROM listings
ORDER BY RANDOM()
LIMIT 5;
```

| ID | Rooms | Area | Floor | Address |
|----|-------|------|-------|---------|
| 318166081 | 1 | 38.0 | 19 | –ú–æ—Å–∫–≤–∞, –°–ó–ê–û, —Ä-–Ω –•–æ—Ä–æ—à–µ–≤–æ-–ú–Ω–µ–≤–Ω–∏–∫–∏ |
| 321187727 | 2 | 43.89 | 20 | –ú–æ—Å–∫–≤–∞, –°–í–ê–û, —Ä-–Ω –ú–∞—Ä—å–∏–Ω–∞ —Ä–æ—â–∞ |
| 323390622 | 1 | 38.2 | 3 | –ú–æ—Å–∫–≤–∞, –ó–ê–û, –º. –ü–∞–≤—à–∏–Ω–æ |
| 319356196 | 1 | 36.0 | 2 | –ú–æ—Å–∫–≤–∞, –Æ–í–ê–û, —Ä-–Ω –õ—é–±–ª–∏–Ω–æ |
| 310720854 | 3 | 70.4 | 2 | –ú–æ—Å–∫–≤–∞, –ó–ê–û, —Ä-–Ω –û—á–∞–∫–æ–≤–æ-–ú–∞—Ç–≤–µ–µ–≤—Å–∫–æ–µ |

---

## üìù Git –ö–æ–º–º–∏—Ç—ã

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã –∏ –∑–∞–ø—É—à–µ–Ω—ã –Ω–∞ GitHub:

```
57d1464c feat(infra): Setup systemd timer for daily auto-scraping (TASK-004)
a0e0dc2d feat(cli): Enable detailed parsing by default + add quality metrics (TASK-003)
b5a0cef6 fix(parser): Extract property data from OfferSubtitle (TASK-001)
```

**–í–µ—Ç–∫–∞:** `fix1`  
**URL:** https://github.com/nikitaav92-star/realestate/tree/fix1

---

## üîß –ß—Ç–æ –ò–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –ö–æ–¥–µ

### 1. `etl/collector_cian/browser_fetcher.py`
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ OfferSubtitle –ø–µ—Ä–µ–¥ OfferTitle
- Regex –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–æ–º–æ-—Ç–µ–∫—Å—Ç–∞ vs –¥–∞–Ω–Ω—ã—Ö –æ –∫–≤–∞—Ä—Ç–∏—Ä–µ
- Debug –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### 2. `etl/collector_cian/cli.py`
- `--parse-details` —Ç–µ–ø–µ—Ä—å True –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –î–æ–±–∞–≤–ª–µ–Ω `--no-parse-details` –¥–ª—è –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ help –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### 3. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- –°–æ–∑–¥–∞–Ω VIEW `data_quality_metrics`
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ—Ç—ã 6 –∫–ª—é—á–µ–≤—ã—Ö –ø–æ–ª–µ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤

### 4. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- `/etc/systemd/system/cian-scraper.service` - —Å–µ—Ä–≤–∏—Å
- `/etc/systemd/system/cian-scraper.timer` - —Ç–∞–π–º–µ—Ä
- `infra/systemd/README.md` - –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

## üìà –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –î–û vs –ü–û–°–õ–ï

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–û | –ü–û–°–õ–ï | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|-------|-----------|
| –ó–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å rooms | 48.6% | 100% | **+51.4%** |
| –ó–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å area | 32.5% | 100% | **+67.5%** |
| –ó–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç—å floor | 32.1% | 100% | **+67.9%** |
| –û–ø–∏—Å–∞–Ω–∏—è | 0% | 0%* | *–ë—É–¥–µ—Ç 100% —Å –¥–µ—Ç–∞–ª—è–º–∏ |
| –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ | 0% | 0%* | *–ë—É–¥–µ—Ç 100% —Å –¥–µ—Ç–∞–ª—è–º–∏ |
| –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è | ‚ùå | ‚úÖ | **–ï–∂–µ–¥–Ω–µ–≤–Ω–æ** |
| –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ | ‚ùå | ‚úÖ | **SQL view** |

---

## üöÄ –ß—Ç–æ –î–∞–ª—å—à–µ

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–∑–∞–≤—Ç—Ä–∞ –≤ 03:00)
- ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—Å—è systemd timer
- ‚úÖ –°–ø–∞—Ä—Å–∏—Ç 10 —Å—Ç—Ä–∞–Ω–∏—Ü (~280 –æ–±—ä—è–≤–ª–µ–Ω–∏–π)
- ‚úÖ –° –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π (–æ–ø–∏—Å–∞–Ω–∏—è, —Ñ–æ—Ç–æ)
- ‚úÖ –õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `logs/cian-scraper.log`

### –í—Ä—É—á–Ω—É—é (–∫–æ–≥–¥–∞ –ø—Ä–æ—Å–Ω—ë—Ç–µ—Å—å)
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö
psql $PG_DSN -c "SELECT * FROM data_quality_metrics;"

# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
tail -f logs/cian-scraper.log

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å —Ç–∞–π–º–µ—Ä–∞
sudo systemctl status cian-scraper.timer
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ó–∞–¥–∞—á

- [x] TASK-001: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–∞—Ä—Å–∏–Ω–≥ OfferSubtitle (100% –¥–∞–Ω–Ω—ã—Ö)
- [x] TASK-003: –í–∫–ª—é—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- [x] TASK-004: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ (systemd)
- [x] –°–æ–∑–¥–∞—Ç—å SQL view –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- [x] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- [x] –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Git
- [x] –ó–∞–ø—É—à–∏—Ç—å –Ω–∞ GitHub
- [x] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üéâ –ò—Ç–æ–≥–∏

**–ü–∞—Ä—Å–µ—Ä –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —É–ª—É—á—à–µ–Ω\!**

‚úÖ **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã:**
- –î–∞–Ω–Ω—ã–µ —Ç–µ–ø–µ—Ä—å –ø–∞—Ä—Å—è—Ç—Å—è –Ω–∞ 100% (–±—ã–ª–æ 48%)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –∫–∞–∂–¥—É—é –Ω–æ—á—å
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ —á–µ—Ä–µ–∑ SQL

‚úÖ **–ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É:**
- 3 –∫–æ–º–º–∏—Ç–∞ –Ω–∞ GitHub
- –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- Systemd –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

‚úÖ **–°–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—É—Å–∫:**
- –ó–∞–≤—Ç—Ä–∞ –≤ 03:00 UTC
- 10 —Å—Ç—Ä–∞–Ω–∏—Ü (280 –æ–±—ä—è–≤–ª–µ–Ω–∏–π)
- –° –æ–ø–∏—Å–∞–Ω–∏—è–º–∏ –∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏

---

**–°–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏\! üò¥**  
–ü–∞—Ä—Å–µ—Ä —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–Ω–æ–º–Ω–æ.

**–í–æ–ø—Ä–æ—Å—ã —É—Ç—Ä–æ–º:**
- –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å Telegram –∞–ª–µ—Ä—Ç—ã?
- –ö–∞–∫ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å Metabase –¥–∞—à–±–æ—Ä–¥?
- –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–¥–µ–Ω–∏—è —Ü–µ–Ω?

–í—Å–µ –æ—Ç–≤–µ—Ç—ã –≤ `.speckit/ideas/improvements-backlog.md` üìö
