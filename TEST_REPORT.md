# –û—Ç—á–µ—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–∏—Å—Ç–µ–º—ã Real Estate Platform

**–î–∞—Ç–∞:** 2025-11-19  
**–í–µ—Ä—Å–∏—è:** Production  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´**

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ –¢–µ—Å—Ç 1: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **–°—Ç–∞—Ç—É—Å:** PASSED
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏:** –í—Å–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
  - psycopg2 ‚úÖ
  - fastapi ‚úÖ
  - uvicorn ‚úÖ
  - httpx ‚úÖ
  - playwright ‚úÖ
  - pydantic ‚úÖ
  - orjson ‚úÖ
  - PyYAML ‚úÖ
  - python-dotenv ‚úÖ
- **–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏:**
  - flask ‚ö†Ô∏è (–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
  - psycopg ‚ö†Ô∏è (–Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è psycopg2)

### ‚úÖ –¢–µ—Å—Ç 2: –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL
- **–°—Ç–∞—Ç—É—Å:** PASSED
- **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:** –£—Å–ø–µ—à–Ω–æ
- **–î–∞–Ω–Ω—ã–µ:**
  - –û–±—ä—è–≤–ª–µ–Ω–∏–π: **1,562**
  - –ó–∞–ø–∏—Å–µ–π —Ü–µ–Ω: **1,562**
  - –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞: **18,074,770 ‚ÇΩ**
  - –î–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω: **2,300,000 - 30,000,000 ‚ÇΩ**
- **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä:** –ó–∞–ø—É—â–µ–Ω –∏ –∑–¥–æ—Ä–æ–≤ (Up 4 days)

### ‚úÖ –¢–µ—Å—Ç 3: ETL CLI –∫–æ–º–∞–Ω–¥—ã
- **–°—Ç–∞—Ç—É—Å:** PASSED
- **–ú–æ–¥—É–ª–∏:** –í—Å–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ
- **Payload —Ñ–∞–π–ª—ã:** –ù–∞–π–¥–µ–Ω—ã
- **–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
  - `pull` - –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –≤—ã–≤–æ–¥ JSONL
  - `to-db` - –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ PostgreSQL

### ‚úÖ –¢–µ—Å—Ç 4: –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- **–°—Ç–∞—Ç—É—Å:** PASSED
- **FastAPI (web_simple.py):** ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω
- **FastAPI (web_viewer.py):** ‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω
- **Flask (web/app.py):** ‚ö†Ô∏è –ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### ‚úÖ –¢–µ—Å—Ç 5: Anti-bot toolkit
- **–°—Ç–∞—Ç—É—Å:** PASSED
- **–ú–æ–¥—É–ª–∏:** –í—Å–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
  - captcha ‚úÖ
  - proxy ‚úÖ
  - retry ‚úÖ
  - fingerprint ‚úÖ
  - user_agent ‚úÖ
  - behavior ‚úÖ
  - storage ‚úÖ

### ‚úÖ –¢–µ—Å—Ç 6: Product scraper
- **–°—Ç–∞—Ç—É—Å:** PASSED
- **–ú–æ–¥—É–ª–∏:** –í—Å–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã
  - queue ‚úÖ
  - worker ‚úÖ
  - fetcher ‚úÖ
  - cli ‚úÖ

### ‚úÖ –¢–µ—Å—Ç 7: Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- **–°—Ç–∞—Ç—É—Å:** PASSED
- **PostgreSQL:** –ó–∞–ø—É—â–µ–Ω –∏ –∑–¥–æ—Ä–æ–≤
  - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä: `realestate-postgres-1`
  - –°—Ç–∞—Ç—É—Å: `Up 4 days (healthy)`
  - –ü–æ—Ä—Ç: `5432`

---

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **web_viewer.py** - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ –≤ f-string
   - –ó–∞–º–µ–Ω–µ–Ω—ã –ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è `{rooms or }` –Ω–∞ `{rooms or ''}`
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –≤ onclick

2. **etl/antibot/__init__.py** - –î–æ–±–∞–≤–ª–µ–Ω —ç–∫—Å–ø–æ—Ä—Ç `CircuitBreakerConfig`
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç –≤ product_scraper

3. **web_viewer.py** - –ó–∞–º–µ–Ω–µ–Ω `psycopg` –Ω–∞ `psycopg2`
   - –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

---

## üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **–¢–∞–±–ª–∏—Ü—ã:** `listings`, `listing_prices`
- **–ó–∞–ø–∏—Å–µ–π:** 1,562 –æ–±—ä—è–≤–ª–µ–Ω–∏—è —Å —Ü–µ–Ω–∞–º–∏
- **–°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞:** 18,074,770 ‚ÇΩ
- **–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** –î–∞–Ω–Ω—ã–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- **PostgreSQL:** –†–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ (4 –¥–Ω—è uptime)
- **Docker:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã
- **Python:** 3.13.3

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- **ETL Pipeline:** –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ
- **Anti-bot —Å–∏—Å—Ç–µ–º–∞:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞
- **–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã:** 2 FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≥–æ—Ç–æ–≤—ã
- **API:** FastAPI —Å–µ—Ä–≤–∏—Å –≥–æ—Ç–æ–≤

---

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ:
1. –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å CIAN (`etl/collector_cian/cli.py`)
2. –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (`web_viewer.py`, `web_simple.py`)
3. API –¥–ª—è –º–µ—Ç—Ä–∏–∫ (`api/main.py`)
4. Product scraping —Å–∏—Å—Ç–µ–º–∞ (`etl/product_scraper/`)

### ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Flask –¥–ª—è –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ `web/app.py`:
   ```bash
   pip install flask
   ```

2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ `.env`:
   - `PG_DSN` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
   - `ANTICAPTCHA_KEY` - –∫–ª—é—á –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∫–∞–ø—á–∏
   - –ü—Ä–æ–∫—Å–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è)

---

## üìù –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –∑–∞–ø—É—Å–∫–∞

### –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (FastAPI)
```bash
cd /home/ubuntu/realestate
source venv/bin/activate
python web_viewer.py
# –î–æ—Å—Ç—É–ø: http://localhost:8000
```

### API —Å–µ—Ä–≤–∏—Å
```bash
cd /home/ubuntu/realestate
source venv/bin/activate
cd api
uvicorn main:app --host 0.0.0.0 --port 8080
```

### –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö CIAN
```bash
cd /home/ubuntu/realestate
source venv/bin/activate
python -m etl.collector_cian.cli to-db --pages 1
```

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é.**

–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
- ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∞ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ
- ‚úÖ ETL pipeline –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ
- ‚úÖ –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç
- ‚úÖ Anti-bot —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞
- ‚úÖ Docker –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –°–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –¥–ª—è —Å–±–æ—Ä–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏.

